package tests;

import org.openqa.selenium.JavascriptExecutor;
import org.testng.Assert;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;
import pages.BasePage;
import pages.LandingPage;

public class E2ETest extends BasePage{

	LandingPage landingPage;
	JavascriptExecutor js;

	@BeforeTest(alwaysRun = true)
	public void initTest(){

		landingPage = new LandingPage(driver);
		js = (JavascriptExecutor) driver;
	}


	/*
	Added only one end to end test case to display all the possible complexities in the flow and how they were taken care of.

	 */

	@Test(priority=0)
	public void oneE2EFlow() throws InterruptedException {

		for (int i=0;i<250;i++) {
						Assert.assertFalse(landingPage.getTitleOfMovie(Integer.parseInt(String.valueOf(i))).isEmpty());
						Assert.assertTrue(landingPage.isTitleLinkClickable());
						js.executeScript("window.history.go(-1)");
						Assert.assertTrue(landingPage.getPosterOfMovie(Integer.parseInt(String.valueOf(i))).getAttribute("src").contains("amazon"));
						Assert.assertTrue(landingPage.isPosterLinkClickable(Integer.parseInt(String.valueOf(i))));
						Assert.assertFalse(landingPage.getRatingOfMovie(Integer.parseInt(String.valueOf(i))).isEmpty());
						Assert.assertTrue(landingPage.getYourRatingOfMovie(Integer.parseInt(String.valueOf(i))).isDisplayed());
						Assert.assertTrue(landingPage.getWatchListRibbon(Integer.parseInt(String.valueOf(i))).isDisplayed());
						Assert.assertTrue(landingPage.verifyLogo());
						Assert.assertTrue(landingPage.verifyTitle());
						Assert.assertTrue(landingPage.verifySubTitle());
						Assert.assertTrue(landingPage.verifyCharts());
						Assert.assertTrue(landingPage.verifySignInButton());
						Assert.assertTrue(landingPage.verifyRankAndTitlePlaceHolder());
						Assert.assertTrue(landingPage.verifyImdbRatingPlaceHolder());
						Assert.assertTrue(landingPage.verifyYourRatingPlaceHolder());
		}

	}


	@Test(priority=1)
	public void displayFullChart() {
		landingPage.getTableOfMovies();
		landingPage.verifyPageTitle();

	}
}
